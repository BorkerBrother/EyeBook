

<!DOCTYPE html>
<html>
<head>
    <title>eyeBook</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/epubjs/dist/epub.min.js"></script>

    <script src="https://webgazer.cs.brown.edu/webgazer.js?"></script>

    <link rel="stylesheet" type="text/css" href="app.css">
    <script>
        webgazer.setRegression('ridge') /* setzt die Art der Regression auf Ridge */
            .setTracker('clmtrackr') /* setzt den Tracker auf clmtrackr */
            .setGazeListener(function (data, clock) {
                /* hier kann man den Code zur Verarbeitung der Daten einfï¿½gen */
            })
            .begin() /* startet die Verfolgung */
            .showPredictionPoints(true); /* zeigt die Vorhersagepunkte an */

        // Create the focus point element
        var focusPoint = document.createElement("div");
        focusPoint.style.width = "20px";
        focusPoint.style.height = "20px";
        focusPoint.style.borderRadius = "50%";
        focusPoint.style.background = "red";
        focusPoint.style.position = "absolute";
        document.body.appendChild(focusPoint);

        // Get the gaze data from Webgazer.js
        webgazer.setGazeListener(function (data, clock) {
            // Get the x and y coordinates of the gaze point
            var x = data.x;
            var y = data.y;

            // Position the focus point element at the gaze point
            focusPoint.style.left = x + "px";
            focusPoint.style.top = y + "px";

            // Use the coordinates to navigate the PDF
            navigatePDF(x, y);
        });



        // Function to navigate the PDF
        function navigatePDF(x, y) {
            // Get the width and height of the PDF viewer
            var pdfWidth = document.getElementById("book").clientWidth;
            var pdfHeight = document.getElementById("book").clientHeight;

            // Calculate the percentage of the x and y coordinates
            // relative to the width and height of the PDF viewer
            var xPercent = x / pdfWidth;
            var yPercent = y / pdfHeight;

            // Use the percentages to navigate to the corresponding
            // page and position in the PDF
            var iframe = document.getElementById("book").getElementsByTagName("iframe")[0];
            iframe.contentWindow.postMessage({
                xPercent: xPercent,
                yPercent: yPercent
            }, '*');
        }

    </script>

</head>
<video id="webgazerVideoFeed" width="320" height="240" style="display:none;"></video>

<body>
    <div id="area"></div>
    <h1>eyeBook</h1>
    <body>

        <body>
            <div id="reader" style="background-color: antiquewhite; width: 600px; height: 400px"></div>

        </body>

        <script>
            var book = ePub("https://s3.amazonaws.com/moby-dick/moby-dick.epub");
            var rendition = book.renderTo("reader", {
                method: "default",
                width: 600,
                height: 400
            });
            var displayed = rendition.display();

            // Create the prev and next buttons
            var prevButton = document.createElement("button");
            prevButton.innerHTML = "Previous";
            prevButton.style.cssText = "position: absolute; left: 0;";
            var nextButton = document.createElement("button");
            nextButton.innerHTML = "Next";
            nextButton.style.cssText = "position: absolute; right: 0;";

            // Append the buttons to the reader div
            document.getElementById("reader").appendChild(prevButton);
            document.getElementById("reader").appendChild(nextButton);

            prevButton.addEventListener("click", function () {
                var currentLocation = rendition.currentLocation();
                if (currentLocation.start.index > 0) {
                    var prevLocation = currentLocation.start.index - 1;
                    rendition.display(prevLocation);
                }
            });
            nextButton.addEventListener("click", function () {
                var currentLocation = rendition.currentLocation();
                if (currentLocation.start.index < book.spine.length - 1) {
                    var nextLocation = currentLocation.start.index + 1;
                    rendition.display(nextLocation);
                }
            });

        </script>

</html>
